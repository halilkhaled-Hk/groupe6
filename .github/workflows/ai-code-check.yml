name: AI Code Analysis

on: [push, pull_request]

jobs:
  analyze-code:
    runs-on: ubuntu-latest
    name: Analyze Project Structure
    
    steps:
    - name: üì• Checkout code
      uses: actions/checkout@v3
      
    - name: üîç Analyze Files
      run: |
        echo "ü§ñ D√âMARRAGE ANALYSE IA"
        echo "D√©p√¥t: $GITHUB_REPOSITORY"
        echo "Commit: $GITHUB_SHA"
        echo ""
        echo "=== STRUCTURE DU PROJET ==="
        ls -la
        echo ""
        echo "=== FICHIERS TROUV√âS ==="
        
        # V√©rifier les fichiers HTML
        echo "üåê FICHIERS HTML:"
        if [ -f "index.html" ]; then
          lines=$(wc -l < index.html)
          echo "  ‚úÖ index.html ($lines lignes)"
        else
          echo "  ‚ùå index.html - MANQUANT"
        fi
        
        if [ -f "about.html" ]; then
          lines=$(wc -l < about.html)
          echo "  ‚úÖ about.html ($lines lignes)"
        else
          echo "  ‚ùå about.html - MANQUANT"
        fi
        
        # V√©rifier les fichiers JS
        echo ""
        echo "‚ö° FICHIERS JAVASCRIPT:"
        js_files=("logic.js" "buttons.js" "history.js")
        for js_file in "${js_files[@]}"; do
          if [ -f "$js_file" ]; then
            lines=$(wc -l < "$js_file")
            echo "  ‚úÖ $js_file ($lines lignes)"
          else
            echo "  ‚ùå $js_file - MANQUANT"
          fi
        done
        
        # V√©rifier les fichiers CSS
        echo ""
        echo "üé® FICHIERS CSS:"
        css_files=("style.css" "theme.css")
        for css_file in "${css_files[@]}"; do
          if [ -f "$css_file" ]; then
            lines=$(wc -l < "$css_file")
            echo "  ‚úÖ $css_file ($lines lignes)"
          else
            echo "  ‚ùå $css_file - MANQUANT"
          fi
        done
        
        echo ""
        echo "=== ANALYSE TERMIN√âE ==="
        echo "‚úÖ Workflow ex√©cut√© avec succ√®s"

  send-email:
    runs-on: ubuntu-latest
    name: Send Success Email
    needs: analyze-code
    if: success()
    
    steps:
    - name: üìß Send Success Notification
      uses: dawidd6/action-send-mail@v3
      with:
        server_address: smtp.gmail.com
        server_port: 587
        username: ${{ secrets.EMAIL_USERNAME }}
        password: ${{ secrets.EMAIL_PASSWORD }}
        subject: "‚úÖ Commit R√©ussi - Analyse IA Termin√©e"
        to: ${{ secrets.NOTIFICATION_EMAIL }}
        from: "GitHub Actions Bot"
        body: |
          üéâ ANALYSE IA TERMIN√âE AVEC SUCC√àS !
          
          D√©p√¥t: ${{ github.repository }}
          Commit: ${{ github.sha }}
          Branche: ${{ github.ref }}
          Auteur: ${{ github.actor }}
          Date: ${{ github.event.head_commit.timestamp }}
          
          L'analyse de la structure du projet a √©t√© ex√©cut√©e avec succ√®s.
          Tous les fichiers ont √©t√© v√©rifi√©s et le code est op√©rationnel.
          
          üìä R√©sum√© de l'analyse:
          - Structure du projet valid√©e
          - Fichiers HTML, CSS et JS analys√©s
          - Workflow GitHub Actions compl√©t√©
          
          Consultez les d√©tails sur: https://github.com/${{ github.repository }}/actions
          
          Cordialement,
          Votre IA d'Analyse de Code ü§ñ